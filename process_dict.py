import os
import cv2

dict = {'000': ['a01-000u', 'a01-003u', 'a01-007u', 'a01-011u', 'a01-014u', 'a01-020u', 'a01-030u', 'a01-043u', 'a01-049u', 'a01-049x', 'a01-053u', 'a01-058u', 'a01-063u', 'a01-068u', 'a01-072u', 'a01-077u', 'a01-082u', 'a01-087u', 'a01-091u', 'a01-096u', 'a01-102u', 'a01-107u', 'a01-117u', 'a01-122u', 'a01-128u', 'a01-132u', 'a01-132x', 'a01-026u', 'a01-113u', 'a03-073', 'a05-053', 'a03-050', 'a03-071', 'a03-080', 'a03-089', 'a05-000', 'a05-013', 'a05-017', 'a05-022', 'a05-025', 'a05-029', 'a05-039', 'a05-044', 'a05-048', 'a05-058', 'a05-062', 'a05-069', 'a05-073', 'a05-080', 'a05-084', 'a05-089', 'a05-094', 'a05-099', 'a05-104', 'a05-108', 'a05-113', 'a05-116', 'a05-121', 'a05-125'], '001': ['a01-000x', 'a01-072x'], '002': ['a01-003'], '003': ['a01-003x', 'a01-007x'], '004': ['a01-007'], '005': ['a01-011', 'a01-030'], '006': ['a01-011x'], '007': ['a01-014', 'a01-038'], '008': ['a01-014x', 'a01-026x'], '009': ['a01-020', 'a01-026'], '010': ['a01-020x', 'a01-030x'], '011': ['a01-038x', 'a01-043x'], '012': ['a01-043', 'a01-049'], '013': ['a01-053', 'a01-058', 'a01-063'], '014': ['a01-053x', 'a01-058x'], '015': ['a01-063x'], '016': ['a01-077', 'a01-091', 'a01-102'], '017': ['a01-087', 'b01-057', 'b01-062'], '018': ['a01-107', 'a01-113'], '019': ['a01-117', 'a01-122', 'a01-128'], '020': ['a01-132'], '021': ['a02-000'], '022': ['a02-004'], '023': ['a02-008'], '024': ['a02-012'], '025': ['a02-017', 'a02-020', 'a02-024', 'a02-027', 'a02-032'], '026': ['a02-037', 'a02-042', 'a02-090', 'a02-093', 'a02-098'], '040': ['a03-006'], '062': ['a04-069', 'a04-066', 'a04-072'], '069': ['a06-020'], '085': ['a06-147', 'a06-124', 'a06-134', 'a06-141', 'a06-157'], '092': ['b01-089', 'b01-084', 'b01-094'], '106': ['b03-114'], '111': ['b04-128', 'b04-107', 'b04-116', 'b04-121'], '118': ['b05-058', 'b05-055', 'b05-062', 'b05-067', 'b05-071'], '132': ['b06-045', 'b06-082', 'c06-047', 'c06-091'], '137': ['c02-000'], '154': ['c03-000e', 'c03-003e', 'c03-007e', 'c03-016e', 'c03-021e', 'c03-081e', 'c03-087e', 'c03-094e', 'c03-096e', 'c03-084e'], '027': ['a02-046'], '028': ['a02-050'], '029': ['a02-053'], '030': ['a02-057'], '031': ['a02-062'], '032': ['a02-067'], '033': ['a02-072'], '034': ['a02-078'], '035': ['a02-082'], '036': ['a02-086'], '037': ['a02-102', 'a02-106', 'a02-111', 'a02-124', 'a03-047'], '038': ['a02-116'], '039': ['a02-120'], '041': ['a03-009'], '042': ['a03-011'], '043': ['a03-014'], '044': ['a03-017'], '045': ['a03-020'], '046': ['a03-023'], '047': ['a03-027'], '048': ['a03-030'], '049': ['a03-034'], '050': ['a03-037'], '051': ['a03-040'], '052': ['a03-043'], '053': ['a03-054'], '054': ['a03-059'], '055': ['a03-063'], '056': ['a03-066'], '058': ['a04-000', 'a04-003', 'a04-006', 'a04-010'], '059': ['a04-015', 'a04-019', 'a04-023', 'a04-027'], '060': ['a04-031', 'a04-035', 'a04-039', 'a04-043'], '061': ['a04-047', 'a04-050', 'a04-054', 'a04-059'], '063': ['a04-081', 'a04-085', 'a04-089'], '064': ['a04-092', 'a04-096', 'a04-099', 'a04-103'], '065': ['a05-004', 'a05-009'], '066': ['a06-000', 'a06-004'], '067': ['a06-008'], '068': ['a06-014'], '070': ['a06-025'], '071': ['a06-036'], '072': ['a06-039'], '073': ['a06-044'], '074': ['a06-051'], '075': ['a06-057'], '076': ['a06-064'], '077': ['a06-070'], '078': ['a06-075'], '079': ['a06-090'], '080': ['a06-095'], '081': ['a06-100'], '082': ['a06-110'], '083': ['a06-114'], '084': ['a06-119', 'a06-128'], '086': ['a06-152'], '087': ['b01-000', 'b01-004', 'b01-009'], '088': ['b01-014', 'b01-018', 'b01-023'], '089': ['b01-027', 'b01-033', 'b01-038'], '090': ['b01-044', 'b01-049', 'b01-053'], '091': ['b01-073', 'b01-079'], '093': ['b01-113', 'b01-118', 'b01-122'], '094': ['b01-127', 'b01-132', 'b01-136'], '095': ['b02-013', 'b02-035'], '096': ['b02-045'], '097': ['b02-097'], '098': ['b02-102'], '099': ['b02-105'], '100': ['b03-025'], '102': ['b03-087', 'b03-092'], '103': ['b03-098'], '104': ['b03-104'], '105': ['b03-109'], '107': ['b04-000', 'b04-004', 'b04-010', 'b04-020'], '108': ['b04-026', 'b04-034', 'b04-040', 'b04-047'], '109': ['b04-054', 'b04-060', 'b04-066', 'b04-075'], '110': ['b04-081', 'b04-089', 'b04-096', 'b04-103'], '112': ['b04-134', 'b04-140', 'b04-147', 'b04-154'], '113': ['b04-162', 'b04-169', 'b04-175', 'b04-181'], '114': ['b04-187', 'b04-195', 'b04-202', 'b04-208'], '115': ['b05-017'], '116': ['b05-032'], '117': ['b05-038', 'b05-042', 'b05-045', 'b05-050'], '119': ['b05-074'], '120': ['b05-079'], '121': ['b05-083', 'b05-098'], '122': ['b05-088'], '123': ['b06-000', 'b06-023', 'b06-097', 'c06-039', 'c06-100'], '124': ['b06-004', 'b06-049', 'b06-075', 'c06-111'], '125': ['b06-008', 'b06-056', 'b06-093', 'c06-005', 'c06-020'], '126': ['b06-012', 'b06-036', 'b06-110', 'c06-052', 'c06-087'], '127': ['b06-015', 'b06-053', 'c06-106'], '128': ['b06-019', 'b06-071', 'c06-027', 'c06-076', 'c06-128'], '129': ['b06-027', 'c06-014', 'c06-103', 'c06-138'], '130': ['b06-032', 'b06-059', 'b06-079', 'c06-000', 'c06-031'], '131': ['b06-042', 'b06-068', 'c06-058', 'c06-095'], '133': ['b06-064', 'b06-100', 'c06-080', 'c06-116', 'c06-043'], '134': ['b06-087', 'b06-090'], '135': ['c01-009', 'c01-014'], '136': ['c01-066'], '138': ['c02-003'], '139': ['c02-007', 'c02-017'], '140': ['c02-012', 'c02-022'], '141': ['c02-026'], '142': ['c02-030'], '143': ['c02-035'], '144': ['c02-049'], '145': ['c02-056'], '146': ['c02-059'], '147': ['c02-078'], '148': ['c02-082'], '149': ['c02-089'], '150': ['c03-000a', 'c03-003a', 'c03-007a', 'c03-016a', 'c03-021a', 'c03-081a', 'c03-084a', 'c03-087a', 'c03-094a', 'c03-096a'], '151': ['c03-000b', 'c03-003b', 'c03-007b', 'c03-016b', 'c03-021b', 'c03-081b', 'c03-084b', 'c03-087b', 'c03-094b', 'c03-096b'], '152': ['c03-000c', 'c03-003c', 'c03-007c', 'c03-016c', 'c03-021c', 'c03-081c', 'c03-084c', 'c03-087c', 'c03-094c', 'c03-096c'], '153': ['c03-000d', 'c03-003d', 'c03-007d', 'c03-021d', 'c03-081d', 'c03-084d', 'c03-087d', 'c03-094d', 'c03-096d', 'c03-016d'], '155': ['c03-000f', 'c03-003f', 'c03-007f', 'c03-021f', 'c03-081f', 'c03-084f', 'c03-087f', 'c03-094f', 'c03-096f'], '156': ['c03-007'], '157': ['c04-000', 'c04-004'], '158': ['c04-008', 'c04-013'], '159': ['c04-017', 'c04-035'], '160': ['c04-023', 'c04-028'], '161': ['c04-039', 'c04-044'], '162': ['c04-050', 'c04-056'], '163': ['c04-061', 'c04-066'], '164': ['c04-075', 'c04-122'], '165': ['c04-080', 'c04-128'], '166': ['c04-089', 'c04-098'], '167': ['c04-105'], '168': ['c04-116', 'c04-110'], '169': ['c04-134', 'c04-139'], '170': ['c04-144', 'c04-150'], '171': ['c04-156', 'c04-160'], '172': ['c04-165', 'c04-170'], '173': ['c06-011', 'd06-008', 'd06-020', 'd06-046', 'd06-063'], '174': ['c06-083', 'd06-015', 'd06-030', 'd06-050', 'd06-082'], '175': ['d01-016', 'd01-019'], '176': ['d01-024'], '177': ['d01-052', 'd01-049'], '178': ['d01-056', 'd01-060'], '179': ['d01-080', 'd01-085'], '180': ['d01-098', 'd01-104'], '181': ['d01-118', 'd01-123'], '182': ['d03-112'], '183': ['d03-117'], '184': ['d04-005', 'd04-008'], '185': ['d04-012', 'd04-016'], '186': ['d04-021', 'd04-028'], '187': ['d04-032', 'd04-037'], '189': ['d04-050'], '188': ['d04-053', 'd04-047'], '190': ['d04-058', 'd04-062'], '191': ['d04-066'], '192': ['d04-071', 'd04-075'], '193': ['d04-081'], '194': ['d04-086', 'd04-089'], '195': ['d04-096', 'd04-101'], '196': ['d04-111'], '197': ['d04-117', 'd04-121'], '198': ['d04-125', 'd04-131'], '199': ['d05-008', 'd05-025', 'd05-030', 'd05-021'], '200': ['d05-013'], '201': ['d05-040'], '202': ['d06-000', 'd06-091'], '203': ['d06-003', 'd06-076', 'd06-111'], '204': ['d06-011', 'd06-107'], '205': ['d06-025', 'd06-104', 'd06-067'], '206': ['d06-027', 'd06-056', 'd06-096'], '207': ['d06-037', 'd06-072', 'd06-100'], '208': ['d06-041', 'd06-060', 'd06-086', 'd06-113'], '209': ['d07-082', 'd07-085', 'd07-089', 'd07-093', 'd07-096', 'd07-100', 'd07-102']}

os.mkdir('./full_page_categorised')


total_moved = 0
counter = 0
total = 0
for key,value in dict.items():
    total+=1
    if(len(value)>=5):     # more than five pages by author
        
        counter+=1
        pg_cnt=0
        os.mkdir('./full_page_categorised/'+key)
        for v in value:
            pg_cnt+=1
            if(pg_cnt==6):
                break
            v+='.png'
            # cropping the image
            print('./form_a-d/'+v)
            img = cv2.imread('./form_a-d/'+v)       # pick image from directory
            img = img[184*4:697*4,20*4:620*4]       # hit and trial dims to remove up and down
            print('./full_page_categorised/'+key+'/'+v)
            if(not cv2.imwrite('./full_page_categorised/'+key+'/'+v,img)):   # save and classify
                print('unable to write')
                break
            
print(total)
print(counter)
print(total_moved)
